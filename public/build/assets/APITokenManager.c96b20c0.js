import{j as e,a as s,u as _,W as y,r as N,F as O}from"./app.293a78a2.js";import{c as C}from"./index.0579b088.js";import{A as W}from"./ActionMessage.7d06ce1d.js";import{A as z}from"./ActionSection.ca3d2e8b.js";import{C as b}from"./Checkbox.ddfcb5ec.js";import{M as E,D as l}from"./DialogModal.25c13a50.js";import{D as R}from"./DangerButton.c50c9ef8.js";import{F as Y}from"./FormSection.b1cb34bc.js";import{I as q}from"./InputError.68b75152.js";import{I as D}from"./InputLabel.8542de9e.js";import{P as u}from"./PrimaryButton.9495eb81.js";import{T as G}from"./TextInput.acc7a464.js";import{S as T}from"./SecondaryButton.6c338189.js";import{S as H}from"./SectionBorder.a2f7b6ec.js";import{u as J}from"./useTypedPage.35d8ff85.js";import"./transition.b3d540a8.js";import"./SectionTitle.713e09e5.js";import"./use-root-containers.dc5aea37.js";c.Content=function({title:n,children:p}){return e("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:s("div",{className:"sm:flex sm:items-start",children:[e("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e("svg",{className:"h-6 w-6 text-red-600",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e("h3",{className:"text-lg font-medium text-gray-900",children:n}),e("div",{className:"mt-4 text-sm text-gray-600",children:p})]})]})})};c.Footer=function({children:n}){return e("div",{className:"px-6 py-4 bg-gray-100 text-right",children:n})};function c({children:o,...n}){return e(E,{...n,children:o})}function de({tokens:o,availablePermissions:n,defaultPermissions:p}){var A,S,F;const h=_(),r=y({name:"",permissions:p}),a=y({permissions:[]}),g=y({}),[P,f]=N.exports.useState(!1),[x,m]=N.exports.useState(null),[v,d]=N.exports.useState(null),I=J();function w(){r.post(h("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{f(!0),r.reset()}})}function M(t){a.setData("permissions",t.abilities),m(t)}function j(){!x||a.put(h("api-tokens.update",[x]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>m(null)})}function B(t){d(t)}function L(){!v||g.delete(h("api-tokens.destroy",[v]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>d(null)})}return s("div",{children:[s(Y,{onSubmit:w,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf.",renderActions:()=>s(O,{children:[e(W,{on:r.recentlySuccessful,className:"mr-3",children:"Created."}),e(u,{className:C({"opacity-25":r.processing}),disabled:r.processing,children:"Create"})]}),children:[s("div",{className:"col-span-6 sm:col-span-4",children:[e(D,{htmlFor:"name",children:"Name"}),e(G,{id:"name",type:"text",className:"mt-1 block w-full",value:r.data.name,onChange:t=>r.setData("name",t.currentTarget.value),autoFocus:!0}),e(q,{message:r.errors.name,className:"mt-2"})]}),n.length>0&&s("div",{className:"col-span-6",children:[e(D,{htmlFor:"permissions",children:"Permissions"}),e("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(t=>e("div",{children:s("label",{className:"flex items-center",children:[e(b,{value:t,checked:r.data.permissions.includes(t),onChange:i=>{r.data.permissions.includes(i.currentTarget.value)?r.setData("permissions",r.data.permissions.filter(k=>k!==i.currentTarget.value)):r.setData("permissions",[i.currentTarget.value,...r.data.permissions])}}),e("span",{className:"ml-2 text-sm text-gray-600",children:t})]})},t))})]})]}),o.length>0?s("div",{children:[e(H,{}),e("div",{className:"mt-10 sm:mt-0",children:e(z,{title:"Manage API Tokens",description:"You may delete any of your existing tokens if they are no longer needed.",children:e("div",{className:"space-y-6",children:o.map(t=>s("div",{className:"flex items-center justify-between",children:[e("div",{className:"break-all",children:t.name}),s("div",{className:"flex items-center",children:[t.last_used_ago&&s("div",{className:"text-sm text-gray-400",children:["Last used ",t.last_used_ago]}),n.length>0?e(u,{className:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:()=>M(t),children:"Permissions"}):null,e(u,{className:"cursor-pointer ml-6 text-sm text-red-500",onClick:()=>B(t),children:"Delete"})]})]},t.id))})})})]}):null,s(l,{isOpen:P,onClose:()=>f(!1),children:[s(l.Content,{title:"API Token",children:[e("div",{children:"Please copy your new API token. For your security, it won't be shown again."}),e("div",{className:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500",children:(F=(S=(A=I.props)==null?void 0:A.jetstream)==null?void 0:S.flash)==null?void 0:F.token})]}),e(l.Footer,{children:e(T,{onClick:()=>f(!1),children:"Close"})})]}),s(l,{isOpen:!!x,onClose:()=>m(null),children:[e(l.Content,{title:"API Token Permissions",children:e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(t=>e("div",{children:s("label",{className:"flex items-center",children:[e(b,{value:t,checked:a.data.permissions.includes(t),onChange:i=>{a.data.permissions.includes(i.currentTarget.value)?a.setData("permissions",a.data.permissions.filter(k=>k!==i.currentTarget.value)):a.setData("permissions",[i.currentTarget.value,...a.data.permissions])}}),e("span",{className:"ml-2 text-sm text-gray-600",children:t})]})},t))})}),s(l.Footer,{children:[e(T,{onClick:()=>m(null),children:"Cancel"}),e(u,{onClick:j,className:C("ml-2",{"opacity-25":a.processing}),disabled:a.processing,children:"Save"})]})]}),s(c,{isOpen:!!v,onClose:()=>d(null),children:[e(c.Content,{title:"Delete API Token",children:"Are you sure you would like to delete this API token?"}),s(c.Footer,{children:[e(T,{onClick:()=>d(null),children:"Cancel"}),e(R,{onClick:L,className:C("ml-2",{"opacity-25":g.processing}),disabled:g.processing,children:"Delete"})]})]})]})}export{de as default};
